<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="app.wllfengshu.dao.ReportDao" >

	<resultMap id="reportList" type="app.wllfengshu.entity.Report">
        <result column="totalCount" property="totalCount" />
        <result column="totalTime" property="totalTime" />
    </resultMap>

	<select id="getReports" resultMap="reportList" >
		SELECT 
			count(*) as totalCount ,
			sum(length) as totalTime
		FROM 
			t_fact_call fc
		WHERE
			fc.call_type = #{call_type} 
			<if test="!user_id.equals('')">AND fc.user_id=#{user_id} </if>
			<if test="!tenant_id.equals('')">AND fc.tenant_id=#{tenant_id} </if>
			<if test="!start_time.equals('')">AND fc.start_time  &gt;  #{start_time}</if>
			<if test="!end_time.equals('')">AND fc.end_time  &lt;  #{end_time}</if>
			LIMIT #{pageStart} ,#{pageEnd} 
	</select>

</mapper>